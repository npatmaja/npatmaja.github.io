<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>

    <script type="text/javascript">
        if (window.location.hostname == 'www.nauvalatmaja.com' || window.location.hostname == 'nauvalatmaja.com') {

          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-58073141-1', 'auto');
          ga('send', 'pageview');  
        }
    </script>

    <title>Rendering Backbone (Sub)View | nauval atmaja</title>
    <meta name="author" content="Nauval Atmaja">
    <meta name="description" content="Nauval Atmaja's personal notes on software development and all that">
    <meta name="keywords" content="software, engineering, software engineering, architecture, software architecture, programming, thought, javascript, node.js, ruby on rails, java, HTML, code, hack, tips, trick, *nix, OSX">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="/feed.xml" rel="alternate" title="www.nauvalatmaja.com" type="application/atom+xml">
    <!-- <link rel="icon" sizes="300x300" href="icon/icon.png"> -->
    <!-- <link rel="icon" sizes="196x196" href="icon/icon-196.png"> -->
    <!-- <link rel="icon" sizes="128x128" href="icon/icon-128.png"> -->
    <!-- <link rel="apple-touch-icon" sizes="128x128" href="icon/icon-128.png"> -->
    <!-- <link rel="apple-touch-icon-precomposed" sizes="128x128" href="icon/icon-128.png"> -->
    <link href="/ico/favicon.ico" rel="shortcut icon">

    <!-- Bootstrap -->
    <link href="/styles/site.css?" rel="stylesheet" media="screen">
    <link rel="stylesheet" type="text/css" href="/vendor/rainbow.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="/scripts/vendor/html5shiv.js"></script>
    <script src="/scripts/vendor/respond.min.js"></script>
    <![endif]-->

    <meta name="generator" content="DocPad v6.69.2" />
    
</head>
<body>

<a href="https://plus.google.com/112846605467404730226?rel=author" class="google googleplus-hidden" title="Google+">Google+</a>

<div class="navbar navbar-default navbar-static-top navbar-shadow">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/"><span class="text-primary">nauval atmaja</span></a>
        </div>
        <div class="collapse navbar-collapse navbar-right">
            <ul class="nav navbar-nav">
                <!--<li><a href="/">Blog</a></li>-->
                <!-- <li><a href="/archives/">Archives</a></li> -->
                
                    <li typeof="sioc:Page", about= /pages/archives/>
                      <a href='/pages/archives/', property="dc:title">Blog Archives</a>
                    </li>
                
                <li class="hidden-xs">
                    <a href="/feed.xml" class="rss"><span class="icon icon-feed"></span></a>
                    <a href="https://twitter.com/novalpas" class="twitter"><span class="icon icon-twitter"></span></a>
                    <a href="https://github.com/npatmaja" class="github"><span class="icon icon-github"></span></a>
                    <a href="https://id.linkedin.com/in/nauvalatmaja/" class="linkedin"><span class="icon icon-linkedin"></span></a>
                </li>
            </ul>
            <form class="navbar-form navbar-right hidden-xs" role="search" action="http://google.com/search"
                  method="get">
                <div class="form-group">
                    <input type="search" name="q" class="form-control" placeholder="Search">
                    <input type="hidden" name="q" value="site:www.nauvalatmaja.com">
                </div>
            </form>
        </div>
    </div>
</div>
<div class="clear">
<div class="container">
    <div class="row">
        <div class="col-sm-12 col-md-10">
            
            <article id="post" class="post">
    
        <h1>Rendering Backbone (Sub)View</h1>
    
    <div class="post-date">Dec 29th, 2014</div>
    <div class="post-content">
        <p>When learning backbone.js (i&#39;m a novice by the way), at first, I was actually having a hard time
to grasp the backbone view. Especially how the best practice to render
the view and build a rather complex view consists of several subviews.
And then, magically I came accross Ian Storm Taylor&#39;s post about 
<a href="http://ianstormtaylor.com/rendering-views-in-backbonejs-isnt-always-simple/">his experience on dealing with backbone subview</a>.
At first I didn&#39;t quiet understand well about the post until I found
<a href="http://stackoverflow.com/questions/9337927/how-to-handle-initializing-and-rendering-subviews-in-backbone-js">a thread on stackoverflow</a>, which was started by <a href="http://ianstormtaylor.com">Ian Storm Taylor</a>.</p>
<p>Based on the posts, I created a simple case study to better understand how it works.
The requirements were to list pairs of username and email input by users.
So at first I created the view as listed below:</p>
<pre class="highlight"><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"application"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">p</span>&gt;</span>Add a user to the user list<span class="hljs-tag">&lt;/<span class="hljs-title">p</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"login"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">ul</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"online-users"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">ul</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"login-template"</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"text/template"</span>&gt;</span><span class="javascript">
  &lt;h1&gt; login &lt;<span class="hljs-regexp">/h1&gt;
  &lt;input id="username" type="text" placeholder="username" /</span>&gt; 
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">id</span> = "<span class="hljs-attribute">email</span>" <span class="hljs-attribute">type</span> = "<span class="hljs-attribute">text</span>" <span class="hljs-attribute">placeholder</span> = "<span class="hljs-attribute">email</span>" /&gt;</span> 
  <span class="hljs-tag">&lt;<span class="hljs-title">button</span> <span class="hljs-attribute">id</span> = "<span class="hljs-attribute">button-login</span>" <span class="hljs-attribute">type</span> = "<span class="hljs-attribute">button</span>"&gt;</span> Login <span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
</span></span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"userlist-template"</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"text/template"</span>&gt;</span><span class="javascript">
  &lt;li&gt;
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">span</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">%=</span> <span class="hljs-attribute">username</span> %&gt;</span> / <span class="hljs-tag">&lt;<span class="hljs-title">%=</span> <span class="hljs-attribute">email</span> %&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">button</span> <span class="hljs-attribute">id</span> = "<span class="hljs-attribute">force-logout</span>"&gt;</span>force logout<span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">li</span>&gt;</span>
</span></span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
</code></pre>
<p>To better visualize, lets see this picture:</p>
<p><img src="/images/backbone-view-schema.png" alt="Application view"></p>
<p>The outer container is <code>#application</code> and inside it there are
two other sub-containers <code>#login</code> and <code>#online-users</code>. Each container
or sub-container is represented in a separated view: <code>AppView</code>, <code>LoginView</code>
and <code>UserListView</code> respectively. To make it
nicely structured, the <code>UserListView</code> has a sub-view
called <code>UserView</code> that renders each pair of username and email 
handles of the button clicked event.
there is an exception for the last view where the view is 
created for each username-password pair then appended in 
the container <code>#online-users</code>.</p>
<p>Now let&#39;s get to the code.</p>
<pre class="highlight"><code class="hljs javascript">app.AppView = Backbone.View.extend({
  el: <span class="hljs-string">'#application'</span>,

  initialize: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">this</span>.users = <span class="hljs-keyword">new</span> app.UserList();

    <span class="hljs-keyword">this</span>.loginView = <span class="hljs-keyword">new</span> app.LoginView();
    <span class="hljs-keyword">this</span>.userListView = <span class="hljs-keyword">new</span> app.UserListView( { collection: <span class="hljs-keyword">this</span>.users } );

    <span class="hljs-keyword">this</span>.listenTo(<span class="hljs-keyword">this</span>.loginView, <span class="hljs-string">'login'</span>, <span class="hljs-keyword">this</span>.login);
  },

  render: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">this</span>.loginView.setElement(<span class="hljs-keyword">this</span>.$(<span class="hljs-string">'#login'</span>)).render();
    <span class="hljs-keyword">this</span>.userListView.setElement(<span class="hljs-keyword">this</span>.$(<span class="hljs-string">'#online-users'</span>)).render();
  },

  <span class="hljs-comment">/* ... */</span>

  login: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(user)</span> </span>{
    <span class="hljs-keyword">this</span>.users.create( user );
  }
});

app.LoginView = Backbone.View.extend({
  template: _.template($(<span class="hljs-string">'#login-template'</span>).html()),

  events: {
    <span class="hljs-string">'click #button-login'</span>: <span class="hljs-string">'login'</span>
  },

  render: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">this</span>.$el.html(<span class="hljs-keyword">this</span>.template());
  },

  login: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
    <span class="hljs-comment">// login logic</span>
  },

  <span class="hljs-comment">/* ... */</span>
});
</code></pre>
<p>Here, the most important thing to connect Backbone view to
the html is the <code>el</code> (element) property. The <code>el</code> property defines to 
which element the view template will be rendered, or at least in this case 
study. In the <code>AppView</code> the <code>el</code> is set to <code>#application</code> 
as the root container of the application. However, for its 
sub-views, the <code>el</code> property is not defined in the view
definition but set dynamically using <code>setElement</code> method.
As Ian suggested, this is done to avoid the unbinding of 
sub-views&#39; events when rendered more than a time.</p>
<p>The instantiation
of sub-views depends on how the sub-views are rendered.
<code>LoginView</code> and <code>UserListView</code> are instantiated in
the <code>initialize</code> method as the application only need 
an instance for each of them. In contrast, <code>UserView</code>
is instantiated for each user (model) as it needs to
associate the button click event inside the view with
the contained model.</p>
<pre class="highlight"><code class="hljs javascript">app.UserListView = Backbone.View.extend({
  initialize: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">this</span>.listenTo(<span class="hljs-keyword">this</span>.collection, <span class="hljs-string">'add'</span>, <span class="hljs-keyword">this</span>.renderOne);
    <span class="hljs-keyword">this</span>.listenTo(<span class="hljs-keyword">this</span>.collection, <span class="hljs-string">'reset'</span>, <span class="hljs-keyword">this</span>.renderAll);
  },

  render: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">this</span>.renderAll();
  },

  renderOne: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(user)</span> </span>{
    <span class="hljs-keyword">var</span> view = <span class="hljs-keyword">new</span> app.UserView( { model: user } );
    <span class="hljs-keyword">this</span>.$el.append(view.render().el);
  },

  renderAll: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">this</span>.collection.each(<span class="hljs-keyword">this</span>.renderOne);
  }
});

app.UserView = Backbone.View.extend({
  template: _.template($(<span class="hljs-string">'#userlist-template'</span>).html()),
  tagName: <span class="hljs-string">'li'</span>,
  events: {
      <span class="hljs-string">'click #force-logout'</span>: <span class="hljs-string">'clear'</span>
  },

  initialize: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">this</span>.listenTo(<span class="hljs-keyword">this</span>.model, <span class="hljs-string">'destroy'</span>, <span class="hljs-keyword">this</span>.remove);
  },

  render: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">this</span>.$el.html( <span class="hljs-keyword">this</span>.template( <span class="hljs-keyword">this</span>.model.attributes ) );
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
  },

  clear: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">this</span>.model.destroy();
  }
});
</code></pre>
<p>To make the code structured nicely, I used the <code>html()</code> and
<code>append()</code> method of Backbone view&#39;s <code>$el</code> property. Some people
might use jquery&#39;s selector <code>$(&#39;.element&#39;)</code> to render the html,
which I think it isn&#39;t clean enough. Lastly, I&#39;ve made a <a href="http://jsfiddle.net/npatmaja/csL45j3s/">fiddle</a>
about this post where you can play around. Hope this post 
helps someone to understand more about backbone view.</p>

    </div>
    
        <div class="twitter-share">
  <a href='https://twitter.com/intent/tweet?text=Rendering+Backbone+(Sub)View&url=http://nauvalatmaja.com/2014/12/29/rendering-backbone-subview/&via=novalpas&hashtags=backbone.js%2Cview%2Cjavascript' class='twitter-share-button' data-via='novalpas' data-count= 'none'><img src='/ico/twitter_white_small.png', width='16px', height='16px'/>tweet</a>
</div>

    
    
        <div class="post-tags">
            Posted In: 
  <a href='/tags/backbone-js/'>backbone.js</a>

  <a href='/tags/view/'>view</a>

  <a href='/tags/javascript/'>javascript</a>
 
        </div>
    
</article> 
            <!-- get next and prev link -->
            
            <div class="page-nav">
              
                
              
                
              
                
              
                
                    
                        <a href="/2014/12/31/setting-up-custom-domain-for-github-pages/" class="page-nav-newer">
                          Setting Up Custom Domain for GitHub Pages <span class="icon icon-arrow-right-2"></span>
                        </a>
                    
                    
                         <a href="/2014/12/28/blogging-with-docpad/" class="page-nav-older">
                          <span class="icon icon-arrow-left-2"></span> Blogging with Docpad
                        </a>
                    
                
              
                
              
            </div>
            <div id="disqus_thread"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
<script type="text/javascript">
    var disqus_shortname = 'nauvalatmaja';
    var disqus_url = 'http://nauvalatmaja.com/2014/12/29/rendering-backbone-subview/';
    var disqus_identifier = disqus_url;
    var disqus_title = 'Rendering Backbone (Sub)View';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>

            <div id="me">
    <p>
        <img src="/images/avatar.png", alt="nauval atmaja">
        Hello, I'm Nauval Atmaja, a software developer who has interest in software architecture and new cool stuff. 
        Unfortunately, I'm no gamer myself but I will still have fun playing Winning Eleven or Pro Evolution Soccer.
        Have a look around and don't hesitate to <a href="mailto:nauval.atmaja@gmail.com">contact me</a> with any comments,
        suggestions or even to just say Hi!
    </p>
    <p>
        <a href="https://twitter.com/novalpas/">@novalpas</a> &#8226;
        <a href="https://github.com/npatmaja">GitHub</a> &#8226;
        <a href="https://id.linkedin.com/in/nauvalatmaja/">linkedin</a> &#8226;
        <a href="mailto:nauval.atmaja@gmail.com">Email Me</a>
    </p>
</div>

        </div>
    </div>
</div>
<div class="container">
    <div class="navbar navbar-footer">
        <p class="navbar-center navbar-text">© Nauval Atmaja 2014</p>
    </div>
</div>


<script src="/vendor/jquery/dist/jquery.js"></script>
<script src="/vendor/mermaid.full.min.js"></script>
<script src="/vendor/components-bootstrap/js/bootstrap.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.pack.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/coffee-script/1.6.3/coffee-script.min.js"></script>



<script type="text/javascript">
	var $buoop = {
		url: 'http://whatbrowser.org/',
        reminder: 0,
		newwindow: false,
		'text': 'You are using an outdated browser (%s). <a%s>More information &#187;</a>',
		'text_af': 'Jy gebruik \'n verouderde webblaaier (%s). <a%s>Meer inligting &#187;</a>',
		'text_cs': 'Používáte zastaralý prohlížeč (%s). <a%s>Více informací &#187;</a>',
		'text_da': 'Du bruger en ældre browser (%s). <a%s>Mere information &#187;</a>',
		'text_de': 'Sie benutzen einen veralteten Browser (%s). <a%s>Mehr Informationen &#187;</a>',
		'text_el': 'Χρησιμοποιείτε ένα ξεπερασμένο πρόγραμμα περιήγησης. <a%s>Περισσότερες πληροφορίες &#187;</a>',
		'text_es': 'Su navegador está obsoleto (%s). <a%s>M&aacute;s informaci&oacute;n &#187;</a>',
		'text_fi': 'Käytät vanhentunutta selainta (%s). <a%s>Lisää tietoa &#187;</a>',
		'text_fr': 'Votre navigateur n\'est pas à jour (%s). <a%s>Plus d\'information &#187;</a>',
		'text_hu': 'A böngészője elavult (%s). <a%s>További információ &#187;</a>',
		'text_id': 'Anda menggunakan web browser versi lama (%s). <a%s>Informasi selengkapnya &#187;</a>',
		'text_is': 'Þú ert að nota úreltan vafra (%s). <a%s>Nánari upplýsingar &#187;</a>',
		'text_it': 'Stai usando un browser datato (%s). <a%s>Ulteriori informazioni &#187;</a>',
		'text_nl': 'U gebruikt op dit moment een verouderde webbrowser (%s). <a%s>Meer informatie &#187;</a>',
		'text_pl': 'Używasz przestarzałej przeglądarki (%s). <a%s>Więcej informacji &#187;</a>',
		'text_pt': 'Você está usando um navegador antigo (%s). <a%s>Mais informações &#187;</a>',
		'text_ro': 'Browserul dumneavoastră este depăşit (%s). <a%s>Mai multe informații &#187;</a>',
		'text_ru': 'Вы используете устаревший браузер (%s). <a%s>Подробнее &#187;</a>',
		'text_sk': 'Používate zastaralý prehliadač (%s). <a%s>Viac informácií &#187;</a>',
		'text_sr': 'Vi koristite zastarelu verziju browsera (%s). <a%s>Vi&#353;e informacija &#187;</a>',
		'text_sv': 'Du använder en gammal webbläsare (%s). <a%s>Mer information &#187;</a>',
		'text_tr': 'Çok eski bir tarayıcı kullanıyorsunuz (%s). <a%s>Daha fazla bilgi &#187;</a>',
		'text_vi': 'Trình duyệt bạn dùng đã lỗi thời rồi (%s). <a%s>Thêm thông tin &#187;</a>'
	};
	$buoop.ol = window.onload;
	window.onload=function(){
		try {if ($buoop.ol) $buoop.ol();}catch (e) {}
		var e = document.createElement("script");
		e.setAttribute("type", "text/javascript");
		e.setAttribute("src", "//browser-update.org/update.js");
		document.body.appendChild(e);
	}
</script>

</body>
</html>