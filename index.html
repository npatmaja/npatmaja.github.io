<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>

    <script type="text/javascript">
        if (window.location.hostname == 'www.nauvalatmaja.com' || window.location.hostname == 'nauvalatmaja.com') {

          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-58073141-1', 'auto');
          ga('send', 'pageview');  
        }
    </script>

    <title>nauval atmaja</title>
    <meta name="author" content="Nauval Atmaja">
    <meta name="description" content="Nauval Atmaja's personal notes on software development and all that">
    <meta name="keywords" content="software, engineering, software engineering, architecture, software architecture, programming, thought, javascript, node.js, ruby on rails, java, HTML, code, hack, tips, trick, *nix, OSX">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="/feed.xml" rel="alternate" title="www.nauvalatmaja.com" type="application/atom+xml">
    <!-- <link rel="icon" sizes="300x300" href="icon/icon.png"> -->
    <!-- <link rel="icon" sizes="196x196" href="icon/icon-196.png"> -->
    <!-- <link rel="icon" sizes="128x128" href="icon/icon-128.png"> -->
    <!-- <link rel="apple-touch-icon" sizes="128x128" href="icon/icon-128.png"> -->
    <!-- <link rel="apple-touch-icon-precomposed" sizes="128x128" href="icon/icon-128.png"> -->
    <link href="/ico/favicon.ico" rel="shortcut icon">

    <!-- Bootstrap -->
    <link href="/styles/site.css?" rel="stylesheet" media="screen">
    <link rel="stylesheet" type="text/css" href="/vendor/rainbow.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="/scripts/vendor/html5shiv.js"></script>
    <script src="/scripts/vendor/respond.min.js"></script>
    <![endif]-->

    <meta name="generator" content="DocPad v6.69.2" />
    
</head>
<body>

<a href="https://plus.google.com/112846605467404730226?rel=author" class="google googleplus-hidden" title="Google+">Google+</a>

<div class="navbar navbar-default navbar-static-top navbar-shadow">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/"><span class="text-primary">nauval atmaja</span></a>
        </div>
        <div class="collapse navbar-collapse navbar-right">
            <ul class="nav navbar-nav">
                <!--<li><a href="/">Blog</a></li>-->
                <!-- <li><a href="/archives/">Archives</a></li> -->
                
                    <li typeof="sioc:Page", about= /pages/archives/>
                      <a href='/pages/archives/', property="dc:title">Blog Archives</a>
                    </li>
                
                <li class="hidden-xs">
                    <a href="/feed.xml" class="rss"><span class="icon icon-feed"></span></a>
                    <a href="https://twitter.com/novalpas" class="twitter"><span class="icon icon-twitter"></span></a>
                    <a href="https://github.com/npatmaja" class="github"><span class="icon icon-github"></span></a>
                    <a href="https://id.linkedin.com/in/nauvalatmaja/" class="linkedin"><span class="icon icon-linkedin"></span></a>
                </li>
            </ul>
            <form class="navbar-form navbar-right hidden-xs" role="search" action="http://google.com/search"
                  method="get">
                <div class="form-group">
                    <input type="search" name="q" class="form-control" placeholder="Search">
                    <input type="hidden" name="q" value="site:www.nauvalatmaja.com">
                </div>
            </form>
        </div>
    </div>
</div>
<div class="clear">
<div class="container">
    <div class="row">
        <div class="col-sm-12 col-md-10">
            
    <article id="post" class="post">
    
        <h1><a href='/2015/01/30/upload-files-with-backbone-nodejs-express-4/'>Upload Files with Backbone.js, Node.js and express 4.x</a></h1>
    
    <div class="post-date">Jan 30th, 2015</div>
    <div class="post-content">
        <p><a href="https://github.com/addyosmani/backbone-fundamentals">Backbone fundamentals</a>
is a great <em>free</em> resource to learn Backbone.js from scratch. The book was written by 
<a href="http://addyosmani.com/">Addy Osmany</a> under <a href="https://en.wikipedia.org/wiki/Creative_Commons_license">creative-commons license</a>.
As its second exercise, the book guide the readers to create a simple library application
that uses Node.js as the back-end. However, it left the part to upload book&#39;s cover
to the readers as an exercise. Hence, here is the way I did it.</p>
<h1 id="requirement">Requirement</h1>
<p>There are two additional requirements for the upload book&#39;s cover features:</p>
<ul>
<li><p>The selected cover should be previewed as thumbnail</p>
<p>This implies that there should be a space to show the selected
image. When users change the image, the preview should change 
accordingly.</p>
</li>
<li><p>Upload process shall happen only when a new book is added</p>
<p>The upload happens if and only if when users click the button
to add a new book. This signifies that the displaying the cover&#39;s
preview should not upload to image file to the server.</p>
</li>
</ul>
<h1 id="problems">Problems</h1>
<p>After browsing for awhile, I found <a href="http://markdawson.tumblr.com/post/18359176420/asynchronous-file-uploading-using-express-and">a blog post to upload file asynchronously using Node.js and express</a>, which was good
as a starting point. However, similar to most of online references I had found, 
they were pretty much obsolete; most of them were using express &lt;= 3.x that supported file upload
by using <code>body-parse</code> middleware (as mentioned in the blog post) where in express
4.x the <code>body-parse</code> middleware did not support file upload any longer.</p>
<p>Another problem was to address the requirement: previewing images without
upload them to the server in the first place. This was tricky, as most of the 
solutions were to have the images uploaded first then fetch the images&#39; URL 
to be previewed.</p>
<h1 id="solution">Solution</h1>
<p>I had to admit, the first problem is another RTFM problem. So when I read again
<a href="https://github.com/expressjs/body-parser"><code>body-parser</code>&#39;s documentation</a> it was
written clearly that <code>body-parse</code> did not handle multipart bodies (file uploads).
Furthermore, it mentioned the alternatives modules to handle multipart bodies, and
one of them is <a href="https://www.npmjs.com/package/multer#readme">multer</a>.</p>
<p>Just like another express middleware, I needed to tell express to use multer and
specified to which directory the files will be uploaded as shown in the following
coffeescript code (yes, I wrote the back-end using coffeescript).</p>
<pre class="highlight"><code class="hljs coffeescript">express = <span class="hljs-built_in">require</span> <span class="hljs-string">'express'</span>
multer = <span class="hljs-built_in">require</span> <span class="hljs-string">'multer'</span>

app = express()
app.use multer( { <span class="hljs-attribute">dest</span>: <span class="hljs-string">"<span class="hljs-subst">#{__root}</span>/public/img/covers/"</span> } )
</code></pre>
<p>For the second problem, I found out that javascript provides a 
<a href="https://developer.mozilla.org/en-US/docs/Web/API/FileReader"><code>FileReader</code> object whose capable of reading file from client&#39;s machine</a>, 
<a href="https://developer.mozilla.org/en-US/docs/Using_files_from_web_applications#Example.3A_Showing_thumbnails_of_user-selected_images">which could be used to load a selected image from a browser locally</a>.</p>
<p>The following code is a Backbone view to handle the feature to display the selected image.
The main idea is to catch the <code>change</code> event from an <code>&lt;input type=&quot;file&quot;&gt;</code> and read the file
and render it through the designated <code>&lt;img&gt;</code> element and later on to upload the file as well.</p>
<pre class="highlight"><code class="hljs javascript">app.ThumbnailView = Backbone.View.extend({
  events: {
    <span class="hljs-string">'change #coverImageUpload'</span>: <span class="hljs-string">'renderThumb'</span>,
    <span class="hljs-string">'submit #uploadCoverForm'</span>: <span class="hljs-string">'upload'</span>
  },

  render: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">this</span>.renderThumb();
  },

  renderThumb: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">var</span> input = <span class="hljs-keyword">this</span>.$(<span class="hljs-string">'#coverImageUpload'</span>);
    <span class="hljs-keyword">var</span> img = <span class="hljs-keyword">this</span>.$(<span class="hljs-string">'#uploadedImage'</span>)[<span class="hljs-number">0</span>];
    <span class="hljs-keyword">if</span>(input.val() !== <span class="hljs-string">''</span>) {
      <span class="hljs-keyword">var</span> selected_file = input[<span class="hljs-number">0</span>].files[<span class="hljs-number">0</span>];
      <span class="hljs-keyword">var</span> reader = <span class="hljs-keyword">new</span> FileReader();
      reader.onload = (<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(aImg)</span> </span>{ <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span> </span>{ aImg.src = e.target.result; }; })(img);
      reader.readAsDataURL(selected_file);
    }
  },

  submit: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">this</span>.$form = <span class="hljs-keyword">this</span>.$(<span class="hljs-string">'#uploadCoverForm'</span>);
    <span class="hljs-keyword">this</span>.$form.submit();
  },

  upload: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">var</span> _this = <span class="hljs-keyword">this</span>;
    <span class="hljs-keyword">this</span>.$form.ajaxSubmit({
      error: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(xhr)</span> </span>{
        _this.renderStatus(<span class="hljs-string">'Error: '</span> + xhr.status);
      },
      success: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(response)</span> </span>{
        _this.trigger(<span class="hljs-string">'image-uploaded'</span>, response.path);
        _this.clearField();
      }
    });
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  },

  renderStatus: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(status)</span> </span>{
     $(<span class="hljs-string">'#status'</span>).text(status);
  },

  clearField: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">this</span>.$(<span class="hljs-string">'#uploadedImage'</span>)[<span class="hljs-number">0</span>].src = <span class="hljs-string">''</span>;
    <span class="hljs-keyword">this</span>.$(<span class="hljs-string">'#coverImageUpload'</span>).val(<span class="hljs-string">''</span>);
  }
});
</code></pre><p>In details, when a user has selected a cover image, the <code>&#39;change #coverImageUpload&#39;: &#39;renderThumb&#39;</code> 
event will be triggered. To add a bit context, <code>#coverImageUpload</code> is the id of the <code>&lt;input type=&quot;file&quot;&gt;</code>
to upload a file and <code>renderThumb</code> is the function will be executed as the event&#39;s callback. In the
function, whenever a user selected a picture, the view will get the selected file and read the file
as data URL through <code>FileReader.readAsDataURL</code> function. When the particular function is executed,
it triggers <code>FileReader</code>&#39;s <code>onload</code> event with the result of the data reading process as its callback&#39;s
parameter, which is used as the image source of the <code>&lt;img&gt;</code> element as shown in the listing above.</p>
<p>The uploading part was a bit tricky. I used Backbone View&#39;s event to make sure
that the newly added book has the right cover image. The way to do this is to
make sure when a user clicks the <strong>add book button</strong>, the cover image
will be uploaded first and when the the upload success an event will be 
triggered with the server path of the uploaded image as the parameter. Then the path will 
be used as the value of <code>&lt;input&gt;</code> related to the book cover. The last step
is to create the book object in the Backbone Collection, which will be 
sync&#39;d to the Node.js back-end server. The following sequence diagram 
pictures the description above.</p>
<div class="mermaid">
sequenceDiagram
  User->>LibraryView: click add book button
  LibraryView->>ThumbnailView: upload
  ThumbnailView->>ThumbnailView: trigger('uploaded', response.path)
  opt uploaded event
    LibraryView->>LibraryView: updateInput
    LibraryView->>LibraryView: createData
  end
</div>
<p>To enable the event in the <code>LibraryView</code>, the object needs to listen to
to the <code>ThumbnailView</code>.</p>
<pre class="highlight"><code class="hljs actionscript">app.LibraryView = Backbone.View.extend({
  ...

  initialize: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(initialBooks)</span> </span>{
    <span class="hljs-keyword">this</span>.collection = <span class="hljs-keyword">new</span> app.Library(initialBooks);

    <span class="hljs-keyword">this</span>.thumbnailView = <span class="hljs-keyword">new</span> app.ThumbnailView();
    <span class="hljs-keyword">this</span>.bookListView = <span class="hljs-keyword">new</span> app.BookListView( { collection: <span class="hljs-keyword">this</span>.collection } );

    <span class="hljs-keyword">this</span>.listenTo(<span class="hljs-keyword">this</span>.thumbnailView, <span class="hljs-string">'image-uploaded'</span>, <span class="hljs-keyword">this</span>.updateInput);
  }
}
</code></pre><p>And that&#39;s all folks! I hope this tutorial could be a help for someone who looks for the solution
for the exercise. Please see the <a href="https://github.com/npatmaja/library">project&#39;s repository</a> 
for the complete solution.</p>

    </div>
    
    
        <div class="post-tags">
            Posted In: 
  <a href='/tags/node-js/'>Node.js</a>

  <a href='/tags/express/'>express</a>

  <a href='/tags/backbone-js/'>Backbone.js</a>

  <a href='/tags/upload/'>upload</a>

  <a href='/tags/multer/'>multer</a>

  <a href='/tags/backbone-fundamentals/'>Backbone Fundamentals</a>
 
        </div>
    
</article>

    <article id="post" class="post">
    
        <h1><a href='/2015/01/13/rendering-mermaid-in-docpad/'>Rendering Mermaid in Docpad</a></h1>
    
    <div class="post-date">Jan 13th, 2015</div>
    <div class="post-content">
        <p>I stumbled across <a href="http://knsv.github.io/mermaid/">Mermaid</a> when I saw 
<a href="https://twitter.com/nikmd23/status/553224624130228225">@ronaldwidha retweeted a tweet about it</a>. 
Mermaid is a library for <em>writing</em> diagrams instead of draw 
them similar to <a href="https://github.com/chjj/marked">Marked</a>
to markdown, awesome! So, I thought I could use this in my blog just in case I 
need to draw some flowcharts or sequence diagrams in the future.</p>
<p>DocPad uses Marked to render markdown to html via 
<a href="https://github.com/docpad/docpad-plugin-marked">docpad-plugin-marked</a> 
but natively, it doesn&#39;t support 
Mermaid syntax. Fortunately, Marked provide 
<a href="https://github.com/chjj/marked#overriding-renderer-methods">a way to override its renderer</a>,
however, it is not yet supported in the current release of the docpad-plugin-marked,
and <a href="https://github.com/docpad/docpad-plugin-marked/issues/11">someone created a ticket on this issue</a>. 
So based on the 
explanation there, I forked the plugin and started to hack it down. 
To add the functionality itself was not that hard but to define a proper test
for the plugin was tougher than it looks, at least at first as I didn&#39;t quite 
understand how DocPad&#39;s plugin tester works. Thanks to <a href="http://www.delarre.net/posts/unit-testing-docpad-plugins/">this awesome post</a>, 
I could finally write and pass the test. The working version of my fork
can be found <a href="https://github.com/npatmaja/docpad-plugin-marked">at my GitHub</a>.</p>
<p>To use the forked plugin, change the dependency definition in <code>package.json</code>:</p>
<pre class="highlight"><code class="hljs undefined">"docpad-plugin-marked": "git+ssh://git@github.com:npatmaja/docpad-plugin-marked.git"
</code></pre>
<p>Next is to redefine the <code>code</code> renderer by putting the definition in the <code>docpad.coffee</code></p>
<pre class="highlight"><code class="hljs coffeescript"><span class="hljs-attribute">plugins</span>:
  <span class="hljs-attribute">marked</span>:
    <span class="hljs-attribute">markedRenderer</span>:
      <span class="hljs-attribute">code</span>: <span class="hljs-function"><span class="hljs-params">(code, lang)</span> -&gt;</span>
<span class="hljs-function">        <span class="hljs-title">escape</span> = <span class="hljs-params">(html, encode)</span> -&gt;</span>
          pattern = <span class="hljs-keyword">if</span> !encode <span class="hljs-keyword">then</span> <span class="hljs-regexp">/&amp;(?!#?\w+;)/g</span>  <span class="hljs-keyword">else</span> <span class="hljs-regexp">/&amp;/g</span>
          <span class="hljs-keyword">return</span> html
            .replace(pattern, <span class="hljs-string">'&amp;amp;'</span>)
            .replace(<span class="hljs-regexp">/&lt;/g</span>, <span class="hljs-string">'&amp;lt;'</span>)
            .replace(<span class="hljs-regexp">/&gt;/g</span>, <span class="hljs-string">'&amp;gt;'</span>)
            .replace(<span class="hljs-regexp">/"/g</span>, <span class="hljs-string">'&amp;quot;'</span>)
            .replace(<span class="hljs-regexp">/'/g</span>, <span class="hljs-string">'&amp;#39;'</span>)

        <span class="hljs-keyword">if</span> code.match(<span class="hljs-regexp">/^sequenceDiagram/</span>)|| code.match(<span class="hljs-regexp">/^graph/</span>)
          <span class="hljs-keyword">return</span> <span class="hljs-string">"&lt;div class=\"mermaid\"&gt;\n<span class="hljs-subst">#{code}</span>\n&lt;/div&gt;\n"</span>
        <span class="hljs-keyword">else</span>
          <span class="hljs-keyword">if</span> <span class="hljs-property">@options</span>.highlight
            out = <span class="hljs-property">@options</span>.highlight code, lang
            <span class="hljs-keyword">if</span> out != <span class="hljs-literal">null</span> &amp;&amp; out != code
              escaped = <span class="hljs-literal">true</span>
              code = out

          <span class="hljs-keyword">if</span> !lang
            <span class="hljs-keyword">return</span> <span class="hljs-string">'&lt;pre&gt;&lt;code&gt;'</span> +
              (<span class="hljs-keyword">if</span> escaped <span class="hljs-keyword">then</span> code <span class="hljs-keyword">else</span> escape(code, <span class="hljs-literal">true</span>)) +
              <span class="hljs-string">'\n&lt;/code&gt;&lt;/pre&gt;'</span>

          <span class="hljs-keyword">return</span> <span class="hljs-string">'&lt;pre&gt;&lt;code class="'</span> +
            <span class="hljs-keyword">this</span>.options.langPrefix +
            escape(lang, <span class="hljs-literal">true</span>) +
            <span class="hljs-string">'"&gt;'</span> +
            (<span class="hljs-keyword">if</span> escaped <span class="hljs-keyword">then</span> code <span class="hljs-keyword">else</span> escape(code, <span class="hljs-literal">true</span>)) +
            <span class="hljs-string">'\n&lt;/code&gt;&lt;/pre&gt;\n'</span>
</code></pre><p>Lastly, I added Mermaid.js to blog&#39;s layout as mentioned on Mermaid&#39;s
documentation. Now all are set to their place, so whenever I put Mermaid 
syntax in a markdown&#39;s code block <code>```</code> the code will 
be transformed to svg image. </p>
<p>Without further ado, below are a couple of examples of Mermaid diagram
definition and their respective rendered diagram. It&#39;s show time!</p>
<h1 id="simple-graph">Simple graph</h1>
<pre class="highlight"><code class="hljs livecodeserver">%% remove comment <span class="hljs-built_in">to</span> render <span class="hljs-operator">the</span> graph
graph TB 
  subgraph <span class="hljs-constant">one</span> 
    a1<span class="hljs-comment">--&gt;a2</span>
  <span class="hljs-function"><span class="hljs-keyword">end</span></span>
  subgraph <span class="hljs-constant">two</span>
    b1<span class="hljs-comment">--&gt;b2</span>
  <span class="hljs-function"><span class="hljs-keyword">end</span></span>
  subgraph <span class="hljs-constant">three</span>
    c1<span class="hljs-comment">--&gt;c2</span>
  <span class="hljs-function"><span class="hljs-keyword">end</span></span>
  c1<span class="hljs-comment">--&gt;a2</span>
</code></pre><div class="mermaid">
graph TB 
  subgraph one 
    a1-->a2
  end
  subgraph two
    b1-->b2
  end
  subgraph three
    c1-->c2
  end
  c1-->a2
</div>
<h1 id="sequence-diagram">Sequence diagram</h1>
<pre class="highlight"><code class="hljs livecodeserver">%% remove comment <span class="hljs-built_in">to</span> render <span class="hljs-operator">the</span> diagram
sequenceDiagram
  Alice -&gt;&gt; Bob: Hello Bob, how are you?
  Bob<span class="hljs-comment">--&gt;&gt;John: How about you John?</span>
  Bob<span class="hljs-comment">--x Alice: I am good thanks!</span>
  Bob-x John: I am good thanks!
  Note <span class="hljs-constant">right</span> <span class="hljs-operator">of</span> John: Bob thinks <span class="hljs-operator">a</span> <span class="hljs-keyword">long</span>&lt;br/&gt;<span class="hljs-keyword">long</span> <span class="hljs-built_in">time</span>, so <span class="hljs-keyword">long</span>&lt;br/&gt;that <span class="hljs-operator">the</span> <span class="hljs-keyword">text</span> does&lt;br/&gt;<span class="hljs-operator">not</span> fit <span class="hljs-command"><span class="hljs-keyword">on</span> <span class="hljs-title">a</span> <span class="hljs-title">row</span>.</span>

  Bob<span class="hljs-comment">--&gt;Alice: Checking with John...</span>
  Alice-&gt;John: Yes... John, how are you?
</code></pre><div class="mermaid">
sequenceDiagram
  Alice ->> Bob: Hello Bob, how are you?
  Bob-->>John: How about you John?
  Bob--x Alice: I am good thanks!
  Bob-x John: I am good thanks!
  Note right of John: Bob thinks a long<br/>long time, so long<br/>that the text does<br/>not fit on a row.

  Bob-->Alice: Checking with John...
  Alice->John: Yes... John, how are you?
</div>
<h2 id="side-note">Side note</h2>
<p>The CSS I use to style the diagram can be seen <a href="https://raw.githubusercontent.com/npatmaja/nauvalatmaja.com/master/src/render/styles/mermaid.less">here</a>. Happy diagramming!</p>

    </div>
    
    
        <div class="post-tags">
            Posted In: 
  <a href='/tags/mermaid/'>Mermaid</a>

  <a href='/tags/docpad/'>DocPad</a>

  <a href='/tags/marked/'>Marked</a>

  <a href='/tags/docpad-plugin-marked/'>docpad-plugin-marked</a>
 
        </div>
    
</article>

    <article id="post" class="post">
    
        <h1><a href='/2015/01/08/Android-development-with-Genymotion/'>Android Development with Genymotion</a></h1>
    
    <div class="post-date">Jan 8th, 2015</div>
    <div class="post-content">
        <p>I am a noob in android development and one thing I am not
comfortable with is the stock android device emulator.
The default emulator is really slow, the boot-up process could
take minutes in my machine (I won&#39;t say my machine is fast either,
but it is sufficient), the app deployment takes too much time, 
moreover, the interaction is sluggish. Hence, it is a no go.</p>
<p>Up to now, I used my own android phone to test my app. It is fast,
quite responsive, but the downside is I need to connect my phone
to my laptop when I work on the app. Not to mention when I can&#39;t find
my USB cable, disaster. </p>
<p><img src="/images/genymotion.png" alt="Genymotion in action"></p>
<p>Fortunately, there is an alternative to android 
stock emulator called <a href="https://www.genymotion.com">Genymotion</a>. It runs
on top of <a href="https://www.virtualbox.org">VirtualBox</a>, in other words, each android
virtual device is an virtual machine in VirtualBox. To use Genymotion
I have to register in the first place (the free account is sufficient for me) 
and then <a href="https://www.genymotion.com/#!/developers/user-guide#installing-genymotion">downloaded and installed the application</a>. 
Following that, I created a virtual device of my liking
in the Genymotion application. 
As I use Eclipse Android Development Tools, I then installed 
<a href="http://marketplace.eclipse.org/content/genymotion-plugin-eclipse">eclipse plugin for Genymotion</a>. A plugin for 
Android Studio is also available in the Genymotion&#39;s website. Restarted Eclipse and 
all was ready. A note, you need to install VirtualBox to use Genymotion, 
otherwise it will complain about can not starting virtualization or 
something.</p>
<p>At first I was skeptical about this emulator but it turn out to be the
opposite. It runs flawlessly, it boots up very fast and very responsive, and at some
point it is even faster than my phone. More importantly, it consumes considerably less
CPU resources compared to the default emulator, impressive. In the conclusion, I recommend
this emulator for android development over the stock emulator. If you need to access
more features other than camera and GPS, you can always change to the subscribe
version.</p>

    </div>
    
    
        <div class="post-tags">
            Posted In: 
  <a href='/tags/genymotion/'>Genymotion</a>

  <a href='/tags/android/'>android</a>

  <a href='/tags/emulator/'>emulator</a>
 
        </div>
    
</article>

    <article id="post" class="post">
    
        <h1><a href='/2014/12/31/setting-up-custom-domain-for-github-pages/'>Setting Up Custom Domain for GitHub Pages</a></h1>
    
    <div class="post-date">Dec 31st, 2014</div>
    <div class="post-content">
        <p>It has been a couple days since <a href="http://nauvalatmaja.com/">nauvalatmaja.com</a> is online,
and to be honest the process was not as hard as I had imagined. Kudos to 
<a href="http://davidensinger.com/">David Ensinger</a> who has written in details on 
how he <a href="http://davidensinger.com/2013/03/setting-the-dns-for-github-pages-on-namecheap/">set up his custom domain for his GitHub pages</a> and
<a href="http://davidensinger.com/2014/04/transferring-the-dns-from-namecheap-to-cloudflare-for-github-pages/">tweak it to get faster by using cloudflare</a>. All
the needed information to do this can be found there.</p>
<p>I purchased this this domain name at <a href="https://www.namecheap.com/">NameCheap</a>, as suggested by David&#39;s post,
with just a bit more than five bucks for a year. Then, I used the free plan of <a href="https://cloudflare.com">CloudFlare</a>
for the DNSs, which I think it is sufficient for my need, and set up the DNS records using <code>CNAME</code>
on the CloudFlare panel to point to my GitHub Pages address. Lastly,
<a href="https://help.github.com/articles/setting-up-a-custom-domain-with-github-pages/">I add a <code>CNAME</code> file in the root directory of my GitHub Pages repository to redirect it</a>. 
And that&#39;s it, practically the process is done after you transfer the DNS from NameCheap to
CloudFlare, you may need to wait for a while to make the changes take effect.</p>
<p>It took me less than three hours, more or less, to make my custom domain
accessible. Frankly, I spent more hours thinking the custom domain name I 
should use than did the actual setup. I am quite happy with the 
setup, hosting static pages on GitHub is right decision. It is simple, easy
and particularly fast, well it&#39;s static html pages anyway.</p>

    </div>
    
    
        <div class="post-tags">
            Posted In: 
  <a href='/tags/github-pages/'>GitHub Pages</a>

  <a href='/tags/custom-domain/'>custom domain</a>

  <a href='/tags/namecheap/'>NameCheap</a>

  <a href='/tags/cloudflare/'>CloudFlare</a>
 
        </div>
    
</article>

    <article id="post" class="post">
    
        <h1><a href='/2014/12/29/rendering-backbone-subview/'>Rendering Backbone (Sub)View</a></h1>
    
    <div class="post-date">Dec 29th, 2014</div>
    <div class="post-content">
        <p>When learning backbone.js (i&#39;m a novice by the way), at first, I was actually having a hard time
to grasp the backbone view. Especially how the best practice to render
the view and build a rather complex view consists of several subviews.
And then, magically I came accross Ian Storm Taylor&#39;s post about 
<a href="http://ianstormtaylor.com/rendering-views-in-backbonejs-isnt-always-simple/">his experience on dealing with backbone subview</a>.
At first I didn&#39;t quiet understand well about the post until I found
<a href="http://stackoverflow.com/questions/9337927/how-to-handle-initializing-and-rendering-subviews-in-backbone-js">a thread on stackoverflow</a>, which was started by <a href="http://ianstormtaylor.com">Ian Storm Taylor</a>.</p>
<p>Based on the posts, I created a simple case study to better understand how it works.
The requirements were to list pairs of username and email input by users.
So at first I created the view as listed below:</p>
<pre class="highlight"><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"application"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">p</span>&gt;</span>Add a user to the user list<span class="hljs-tag">&lt;/<span class="hljs-title">p</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"login"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">ul</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"online-users"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">ul</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"login-template"</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"text/template"</span>&gt;</span><span class="javascript">
  &lt;h1&gt; login &lt;<span class="hljs-regexp">/h1&gt;
  &lt;input id="username" type="text" placeholder="username" /</span>&gt; 
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">id</span> = "<span class="hljs-attribute">email</span>" <span class="hljs-attribute">type</span> = "<span class="hljs-attribute">text</span>" <span class="hljs-attribute">placeholder</span> = "<span class="hljs-attribute">email</span>" /&gt;</span> 
  <span class="hljs-tag">&lt;<span class="hljs-title">button</span> <span class="hljs-attribute">id</span> = "<span class="hljs-attribute">button-login</span>" <span class="hljs-attribute">type</span> = "<span class="hljs-attribute">button</span>"&gt;</span> Login <span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
</span></span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"userlist-template"</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"text/template"</span>&gt;</span><span class="javascript">
  &lt;li&gt;
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">span</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">%=</span> <span class="hljs-attribute">username</span> %&gt;</span> / <span class="hljs-tag">&lt;<span class="hljs-title">%=</span> <span class="hljs-attribute">email</span> %&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">button</span> <span class="hljs-attribute">id</span> = "<span class="hljs-attribute">force-logout</span>"&gt;</span>force logout<span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">li</span>&gt;</span>
</span></span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
</code></pre>
<p>To better visualize, lets see this picture:</p>
<p><img src="/images/backbone-view-schema.png" alt="Application view"></p>
<p>The outer container is <code>#application</code> and inside it there are
two other sub-containers <code>#login</code> and <code>#online-users</code>. Each container
or sub-container is represented in a separated view: <code>AppView</code>, <code>LoginView</code>
and <code>UserListView</code> respectively. To make it
nicely structured, the <code>UserListView</code> has a sub-view
called <code>UserView</code> that renders each pair of username and email 
handles of the button clicked event.
there is an exception for the last view where the view is 
created for each username-password pair then appended in 
the container <code>#online-users</code>.</p>
<p>Now let&#39;s get to the code.</p>
<pre class="highlight"><code class="hljs javascript">app.AppView = Backbone.View.extend({
  el: <span class="hljs-string">'#application'</span>,

  initialize: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">this</span>.users = <span class="hljs-keyword">new</span> app.UserList();

    <span class="hljs-keyword">this</span>.loginView = <span class="hljs-keyword">new</span> app.LoginView();
    <span class="hljs-keyword">this</span>.userListView = <span class="hljs-keyword">new</span> app.UserListView( { collection: <span class="hljs-keyword">this</span>.users } );

    <span class="hljs-keyword">this</span>.listenTo(<span class="hljs-keyword">this</span>.loginView, <span class="hljs-string">'login'</span>, <span class="hljs-keyword">this</span>.login);
  },

  render: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">this</span>.loginView.setElement(<span class="hljs-keyword">this</span>.$(<span class="hljs-string">'#login'</span>)).render();
    <span class="hljs-keyword">this</span>.userListView.setElement(<span class="hljs-keyword">this</span>.$(<span class="hljs-string">'#online-users'</span>)).render();
  },

  <span class="hljs-comment">/* ... */</span>

  login: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(user)</span> </span>{
    <span class="hljs-keyword">this</span>.users.create( user );
  }
});

app.LoginView = Backbone.View.extend({
  template: _.template($(<span class="hljs-string">'#login-template'</span>).html()),

  events: {
    <span class="hljs-string">'click #button-login'</span>: <span class="hljs-string">'login'</span>
  },

  render: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">this</span>.$el.html(<span class="hljs-keyword">this</span>.template());
  },

  login: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
    <span class="hljs-comment">// login logic</span>
  },

  <span class="hljs-comment">/* ... */</span>
});
</code></pre>
<p>Here, the most important thing to connect Backbone view to
the html is the <code>el</code> (element) property. The <code>el</code> property defines to 
which element the view template will be rendered, or at least in this case 
study. In the <code>AppView</code> the <code>el</code> is set to <code>#application</code> 
as the root container of the application. However, for its 
sub-views, the <code>el</code> property is not defined in the view
definition but set dynamically using <code>setElement</code> method.
As Ian suggested, this is done to avoid the unbinding of 
sub-views&#39; events when rendered more than a time.</p>
<p>The instantiation
of sub-views depends on how the sub-views are rendered.
<code>LoginView</code> and <code>UserListView</code> are instantiated in
the <code>initialize</code> method as the application only need 
an instance for each of them. In contrast, <code>UserView</code>
is instantiated for each user (model) as it needs to
associate the button click event inside the view with
the contained model.</p>
<pre class="highlight"><code class="hljs javascript">app.UserListView = Backbone.View.extend({
  initialize: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">this</span>.listenTo(<span class="hljs-keyword">this</span>.collection, <span class="hljs-string">'add'</span>, <span class="hljs-keyword">this</span>.renderOne);
    <span class="hljs-keyword">this</span>.listenTo(<span class="hljs-keyword">this</span>.collection, <span class="hljs-string">'reset'</span>, <span class="hljs-keyword">this</span>.renderAll);
  },

  render: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">this</span>.renderAll();
  },

  renderOne: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(user)</span> </span>{
    <span class="hljs-keyword">var</span> view = <span class="hljs-keyword">new</span> app.UserView( { model: user } );
    <span class="hljs-keyword">this</span>.$el.append(view.render().el);
  },

  renderAll: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">this</span>.collection.each(<span class="hljs-keyword">this</span>.renderOne);
  }
});

app.UserView = Backbone.View.extend({
  template: _.template($(<span class="hljs-string">'#userlist-template'</span>).html()),
  tagName: <span class="hljs-string">'li'</span>,
  events: {
      <span class="hljs-string">'click #force-logout'</span>: <span class="hljs-string">'clear'</span>
  },

  initialize: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">this</span>.listenTo(<span class="hljs-keyword">this</span>.model, <span class="hljs-string">'destroy'</span>, <span class="hljs-keyword">this</span>.remove);
  },

  render: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">this</span>.$el.html( <span class="hljs-keyword">this</span>.template( <span class="hljs-keyword">this</span>.model.attributes ) );
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
  },

  clear: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">this</span>.model.destroy();
  }
});
</code></pre>
<p>To make the code structured nicely, I used the <code>html()</code> and
<code>append()</code> method of Backbone view&#39;s <code>$el</code> property. Some people
might use jquery&#39;s selector <code>$(&#39;.element&#39;)</code> to render the html,
which I think it isn&#39;t clean enough. Lastly, I&#39;ve made a <a href="http://jsfiddle.net/npatmaja/csL45j3s/">fiddle</a>
about this post where you can play around. Hope this post 
helps someone to understand more about backbone view.</p>

    </div>
    
    
        <div class="post-tags">
            Posted In: 
  <a href='/tags/backbone-js/'>backbone.js</a>

  <a href='/tags/view/'>view</a>

  <a href='/tags/javascript/'>javascript</a>
 
        </div>
    
</article>


<div class="page-nav">
    
    <a class="page-nav-older" href="/index.1/"><span class="icon icon-arrow-left-2"></span> Older</a>
    
    
    <div class="page-nav-archives"><a href="/pages/archives/">- Blog Archives -</a></div>
</div>

<div id="me">
    <p>
        <img src="/images/avatar.png", alt="nauval atmaja">
        Hello, I'm Nauval Atmaja, a software developer who has interest in software architecture and new cool stuff. 
        Unfortunately, I'm no gamer myself but I will still have fun playing Winning Eleven or Pro Evolution Soccer.
        Have a look around and don't hesitate to <a href="mailto:nauval.atmaja@gmail.com">contact me</a> with any comments,
        suggestions or even to just say Hi!
    </p>
    <p>
        <a href="https://twitter.com/novalpas/">@novalpas</a> &#8226;
        <a href="https://github.com/npatmaja">GitHub</a> &#8226;
        <a href="https://id.linkedin.com/in/nauvalatmaja/">linkedin</a> &#8226;
        <a href="mailto:nauval.atmaja@gmail.com">Email Me</a>
    </p>
</div>

        </div>
    </div>
</div>
<div class="container">
    <div class="navbar navbar-footer">
        <p class="navbar-center navbar-text">© Nauval Atmaja 2014</p>
    </div>
</div>


<script src="/vendor/jquery/dist/jquery.js"></script>
<script src="/vendor/mermaid.full.min.js"></script>
<script src="/vendor/components-bootstrap/js/bootstrap.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.pack.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/coffee-script/1.6.3/coffee-script.min.js"></script>



<script type="text/javascript">
	var $buoop = {
		url: 'http://whatbrowser.org/',
        reminder: 0,
		newwindow: false,
		'text': 'You are using an outdated browser (%s). <a%s>More information &#187;</a>',
		'text_af': 'Jy gebruik \'n verouderde webblaaier (%s). <a%s>Meer inligting &#187;</a>',
		'text_cs': 'Používáte zastaralý prohlížeč (%s). <a%s>Více informací &#187;</a>',
		'text_da': 'Du bruger en ældre browser (%s). <a%s>Mere information &#187;</a>',
		'text_de': 'Sie benutzen einen veralteten Browser (%s). <a%s>Mehr Informationen &#187;</a>',
		'text_el': 'Χρησιμοποιείτε ένα ξεπερασμένο πρόγραμμα περιήγησης. <a%s>Περισσότερες πληροφορίες &#187;</a>',
		'text_es': 'Su navegador está obsoleto (%s). <a%s>M&aacute;s informaci&oacute;n &#187;</a>',
		'text_fi': 'Käytät vanhentunutta selainta (%s). <a%s>Lisää tietoa &#187;</a>',
		'text_fr': 'Votre navigateur n\'est pas à jour (%s). <a%s>Plus d\'information &#187;</a>',
		'text_hu': 'A böngészője elavult (%s). <a%s>További információ &#187;</a>',
		'text_id': 'Anda menggunakan web browser versi lama (%s). <a%s>Informasi selengkapnya &#187;</a>',
		'text_is': 'Þú ert að nota úreltan vafra (%s). <a%s>Nánari upplýsingar &#187;</a>',
		'text_it': 'Stai usando un browser datato (%s). <a%s>Ulteriori informazioni &#187;</a>',
		'text_nl': 'U gebruikt op dit moment een verouderde webbrowser (%s). <a%s>Meer informatie &#187;</a>',
		'text_pl': 'Używasz przestarzałej przeglądarki (%s). <a%s>Więcej informacji &#187;</a>',
		'text_pt': 'Você está usando um navegador antigo (%s). <a%s>Mais informações &#187;</a>',
		'text_ro': 'Browserul dumneavoastră este depăşit (%s). <a%s>Mai multe informații &#187;</a>',
		'text_ru': 'Вы используете устаревший браузер (%s). <a%s>Подробнее &#187;</a>',
		'text_sk': 'Používate zastaralý prehliadač (%s). <a%s>Viac informácií &#187;</a>',
		'text_sr': 'Vi koristite zastarelu verziju browsera (%s). <a%s>Vi&#353;e informacija &#187;</a>',
		'text_sv': 'Du använder en gammal webbläsare (%s). <a%s>Mer information &#187;</a>',
		'text_tr': 'Çok eski bir tarayıcı kullanıyorsunuz (%s). <a%s>Daha fazla bilgi &#187;</a>',
		'text_vi': 'Trình duyệt bạn dùng đã lỗi thời rồi (%s). <a%s>Thêm thông tin &#187;</a>'
	};
	$buoop.ol = window.onload;
	window.onload=function(){
		try {if ($buoop.ol) $buoop.ol();}catch (e) {}
		var e = document.createElement("script");
		e.setAttribute("type", "text/javascript");
		e.setAttribute("src", "//browser-update.org/update.js");
		document.body.appendChild(e);
	}
</script>

</body>
</html>